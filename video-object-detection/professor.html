<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Professor Dashboard - Attendance System</title>
    <link rel="stylesheet" href="styles2.css">
    <link rel="icon" type="image/x-icon" href="favicon.ico">
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="header-left">
                <div class="logo-icon">üë®‚Äçüè´</div>
                <h1 class="header-title">Professor Dashboard</h1>
            </div>
            <div class="header-right">
                <span class="welcome-text">Welcome, Dr. Smith</span>
                <button class="logout-btn" onclick="logout()">
                    <div class="logout-sign">
                        <svg viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg">
                            <path d="M377.9 105.9L500.7 228.7c7.2 7.2 11.3 17.1 11.3 27.3s-4.1 20.1-11.3 27.3L377.9 406.1c-6.4 6.4-15 9.9-24 9.9c-18.7 0-33.9-15.2-33.9-33.9l0-62.1-128 0c-17.7 0-32-14.3-32-32l0-64c0-17.7 14.3-32 32-32l128 0 0-62.1c0-18.7 15.2-33.9 33.9-33.9c9 0 17.6 3.6 24 9.9zM160 96L96 96c-17.7 0-32 14.3-32 32l0 256c0 17.7 14.3 32 32 32l64 0c17.7 0 32 14.3 32 32s-14.3 32-32 32l-64 0c-53 0-96-43-96-96L0 128C0 75 43 32 96 32l64 0c17.7 0 32 14.3 32 32s-14.3 32-32 32z"/>
                        </svg>
                    </div>
                    <div class="logout-text">Logout</div>
                </button>
            </div>
        </div>

        <div class="welcome-section">
            <h2 class="welcome-title">Welcome back!</h2>
            <p class="welcome-subtitle">Manage your classes and track student attendance</p>
        </div>

        <div class="section-card">
            <div class="section-header">
                <h3 class="section-title">Class Management</h3>
                <p class="section-subtitle">Create and manage your class sessions</p>
            </div>
            <div class="section-content">
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem;">
                    <button class="btn btn-primary" onclick="openCreateClass()">Create Session</button>
                    <!-- <button class="btn btn-secondary" onclick="openManualAttendance()">Manual Attendance</button> -->
                    <button class="btn btn-secondary" onclick="openGenerateReport()">Generate Report</button>
                    <!-- <button class="btn btn-secondary" onclick="openStudentManagement()">Manage Students</button> -->
                    <!-- <button class="btn btn-secondary" onclick="openAttendanceCheck()">Check Total Attendance</button> -->
                    <!-- <button class="btn btn-danger" onclick="closeActiveSession()">Close Active Session</button> -->
                </div>
            </div>
        </div>

        <div class="section-card">
            <div class="section-header">
                <h3 class="section-title">Active Session</h3>
            </div>
            <div class="section-content" id="activeSessions">
                <p class="welcome-subtitle">No active session at the moment</p>
            </div>
        </div>
    </div>

    <!-- All Professor Modals -->
    <!-- Create Class Modal -->
    <div id="createClassModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Create Class/Session</h3>
                <button class="close-btn" onclick="closeCreateClass()">&times;</button>
            </div>
            <form id="createClassForm">
                
                <!-- Class Dropdown -->
                <div class="form-group">
                    <label class="form-label">Class</label>
                    <select 
                        class="form-input" 
                        id="classCodeSelect" 
                        required>
                        <option value="">Loading classes...</option>
                    </select>
                </div>
                
                <!-- Group Dropdown -->
                <div class="form-group">
                    <label class="form-label">Group</label>
                    <select 
                        class="form-input" 
                        id="groupNumberSelect" 
                        required 
                        disabled>
                        <option value="">Select a class first</option>
                    </select>
                </div>

                <!-- Manage Roster Button -->
                <div class="form-group">
                    <button 
                        type="button" 
                        id="toggleRosterButton" 
                        class="btn btn-secondary"
                        onclick="toggleRosterManagement()"
                        style="width: 100%;">
                        üë• Manage Roster
                    </button>
                </div>
                
                <!-- Session Name -->
                <div class="form-group">
                    <label class="form-label">Session Name</label>
                    <input 
                        type="text" 
                        class="form-input" 
                        id="className"
                        placeholder="e.g., Tutorial 5 - Data Structures" 
                        required>
                </div>
                
                <!-- Date -->
                <div class="form-group">
                    <label class="form-label">Session Date</label>
                    <input 
                        type="date" 
                        class="form-input" 
                        id="sessionDate"
                        required>
                </div>
                
                <!-- Start Time -->
                <div class="form-group">
                    <label class="form-label">Start Time</label>
                    <input 
                        type="time" 
                        class="form-input" 
                        id="startTime"
                        required>
                </div>
                
                <!-- Duration -->
                <div class="form-group">
                    <label class="form-label">Duration (minutes)</label>
                    <input 
                        type="number" 
                        class="form-input" 
                        id="duration"
                        value="90"
                        min="15"
                        max="180"
                        required>
                </div>

                <!-- Student Roster Section -->
                <div id="studentRosterSection" style="display: none; margin-top: 1.5rem; padding-top: 1.5rem; border-top: 2px solid #e2e8f0;">
                    <div class="form-group">
                        <label class="form-label" style="font-size: 1.1rem; font-weight: 600;">üìã Group Roster Management</label>
                        <p style="color: #64748b; font-size: 0.875rem; margin-bottom: 1rem;">
                            View, search, add, or remove students from this group
                        </p>
                    </div>

                    <!-- Search Box -->
                    <div class="form-group">
                        <input 
                            type="text" 
                            id="studentSearchInput"
                            class="form-input"
                            placeholder="üîç Search students by name, email, or ID..."
                            oninput="searchStudents()"
                            style="margin-bottom: 0.5rem;">
                    </div>

                    <!-- Current Students List -->
                    <div id="currentStudentsList" style="max-height: 200px; overflow-y: auto; margin-bottom: 1rem; border: 1px solid #e2e8f0; border-radius: 8px; padding: 0.5rem;">
                        <p style="text-align: center; color: #94a3b8; padding: 1rem;">
                            Select a group to view roster
                        </p>
                    </div>

                    <!-- Add Student Section -->
                    <div class="form-group">
                        <label class="form-label">Add Student to Group</label>
                        <div style="display: flex; gap: 0.5rem; align-items: center;">
                            <select 
                                id="availableStudentsSelect" 
                                class="form-input" 
                                style="flex: 1;">
                                <option value="">Select a student to add...</option>
                            </select>
                            <button 
                                type="button" 
                                class="btn btn-primary" 
                                onclick="addStudentToGroup()"
                                style="white-space: nowrap;">
                                + Add
                            </button>
                        </div>
                    </div>
                </div>

                <div style="display: flex; gap: 1rem;">
                    <button 
                        type="submit" 
                        class="btn btn-primary" 
                        style="flex: 1;">Create Session</button>
                    <button 
                        type="button" 
                        class="btn btn-secondary" 
                        style="flex: 1;" 
                        onclick="closeCreateClass()">Cancel</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Generate Report Modal -->
    <div id="generateReportModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Generate Attendance Report</h3>
                <button onclick="closeGenerateReport()" class="close-btn">&times;</button>
            </div>
            <div class="form-group">
                <label class="form-label">Select Class</label>
                <select id="classSelect" class="form-select">
                    <option value="">All Classes</option>
                    <option value="CS102" selected>CS102 - Programming Fundamentals II</option>
                    <option value="IS116">IS116 - Web Application Development</option>
                    <option value="COR3001">COR3001 - Big Questions</option>
                </select>
            </div>
            <div class="form-group">
                <label class="form-label">Date Range</label>
                <div style="display: flex; gap: 1rem;">
                    <input type="date" class="form-input" style="flex: 1;">
                    <input type="date" class="form-input" style="flex: 1;">
                </div>
            </div>
            <table class="attendance-table">
                <thead>
                    <tr>
                        <th>Student</th>
                        <th>Total Classes</th>
                        <th>Present</th>
                        <th>Attendance Rate</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>John Doe</td>
                        <td>20</td>
                        <td>18</td>
                        <td><span class="status-badge status-present">90%</span></td>
                    </tr>
                    <tr>
                        <td>Jane Smith</td>
                        <td>20</td>
                        <td>15</td>
                        <td><span class="status-badge status-absent">75%</span></td>
                    </tr>
                </tbody>
            </table>
            <div class="export-buttons">
                <button class="btn btn-success" onclick="exportCSV()">Export as CSV</button>
                <button class="btn btn-danger" onclick="exportPDF()">Export as PDF</button>
                <button onclick="closeGenerateReport()" class ="btn btn-secondary">Close</button>
            </div>
        </div>
    </div>


    <!-- Face Scan Modal -->
      <div id="faceScanModal" class="modal">
        <div class="modal-content" style="max-width: 500px;">
            <div class="modal-header">
                <h3 class="modal-title">Scan Face for Attendance</h3>
                <button class="close-btn" onclick="closeFaceScanning()">&times;</button>
            </div>
            <div class="modal-body">
                <p style="text-align: center; color: #64748b; margin-bottom: 1rem;">
                    Position your face within the frame for attendance verification
                </p>
                <div id="container">
                    <video id="video" autoplay muted playsinline></video>
                    <canvas id="canvas" width="360" height="240"></canvas>
                    <div id="overlay"></div>
                </div>
                 <div id="controls">
                <div>
                    <label>Image size</label>
                    (<label id="size-value">96</label>)
                    <br />
                    <input
                    id="size"
                    type="range"
                    min="64"
                    max="256"
                    step="32"
                    value="96"
                    disabled
                    />
                </div>
                <div>
                    <label>Threshold</label>
                    (<label id="threshold-value">0.85</label>)
                    <br />
                    <input
                    id="threshold"
                    type="range"
                    min="0.01"
                    max="1"
                    step="0.01"
                    value="0.85"
                    disabled
                    />
                </div>
                <div>
                    <label>Scale</label>
                    (<label id="scale-value">0.5</label>)
                    <br />
                    <input
                    id="scale"
                    type="range"
                    min="0.01"
                    max="1"
                    step="0.01"
                    value="0.5"
                    disabled
                    />
                </div>
                </div>
                <label id="status"></label>
                <div id="scanResult" style="text-align: center; margin-bottom: 1rem; display: none;">
                    <div style="color: #22c55e; font-weight: 500;">‚úì Face verified successfully!</div>
                </div>
                <div style="display: flex; gap: 1rem;">
                    <button class="btn btn-secondary" style="flex: 1;" onclick="closeFaceScanning()">Cancel</button>
                </div>
            </div>
        </div>
    </div>

   <script type="module" src="src/professor.js"></script>
   <script type="module" src="src/face-detection-model.js"></script>

</body>
</html>
